import{a as f,b as j,c as u,d as h}from"./chunk-ISB7Q47N.js";import{A as T,B as P,C as L,D as B,E as _,F as l,G as d,H as D,M as N,N as I,U as m,V as E,W as $,Ya as V,_a as H,db as W,ea as z,eb as Z,p as v,q as c,u as R,ya as G,z as S}from"./chunk-V2FJALQZ.js";import"./chunk-447CKG3T.js";import"./chunk-7KGURMOZ.js";import"./chunk-CDZFCBFW.js";import"./chunk-E2CLONXR.js";import"./chunk-KRDHHS7Z.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-LRFGNCHE.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{a as k,b as O}from"./chunk-JHI3MBHO.js";var A=[{inputs:["Azkena Rock Festival"],name:"Azkena Rock Festival",location:"Vitoria-Gasteiz",place:"Recinto Ferial de Vitoria",bands:["Alice Cooper","Corrosion of Conformity","Therapy?","Voivod"]},{inputs:["Be Prog! My Friend"],name:"Be Prog! My Friend",location:"Barcelona",place:"La Carpa (Poble Espanyol)",bands:["The Dear Hunter"]},{inputs:["GinetaRock"],name:"GinetaRock",location:"La Gineta (Albacete)",place:"Recinto Sal\xF3n Municipal de La Gineta",bands:["Seven Spires","Roy Khan"]},{inputs:["Leyendas del Rock"],name:"Leyendas del Rock",location:"Villena (Alicante)",place:"Polideportivo Municipal de Villena",bands:["Helloween","In Flames","Slaughter To Prevail","Black Label Society","Cabal","Chelsea Grin","Chez Kane","Dark Moor","Dark Tranquillity","Deicide","Eihwar","Godsmack","Hardline","Heaven Shall Burn","Latzen","Mushroomhead","Northlane","Nothing More","Of Mice & Men","Orbit Culture","Saratoga","Saurom","Savatage","Sepultura","The Baboon Show","Warcry","ten56."]},{inputs:["Mad Cool"],name:"Mad Cool",location:"Villaverde (Madrid)",place:"Iberdrola Music",bands:["My Chemical Romance"]},{inputs:["O Son Do Camino"],name:"O Son Do Camino",location:"Santiago de Compostela",place:"Monte do Gozo",bands:["Linkin Park"]},{inputs:["Okkult Session"],name:"Okkult Session",location:"Barcelona",place:"La Carpa (Poble Espanyol)",bands:[]},{inputs:["Resurrection Fest"],name:"Resurrection Fest",location:"Viveiro (Lugo)",place:"Complejo deportivo de Lavandeiras",bands:["Iron Maiden","Limp Bizkit","Marilyn Manson","Blood Incantation","Caliban","Cavalera Conspiracy","Converge","Feuerschwanz","Get The Shot","House Of Protection","Imminence","Man With A Mission","P.O.D.","The Rasmus","The Vintage Caravan","Thrown","Trivium"]},{inputs:["Rock Fest"],name:"Rock Fest",location:"Barcelona",place:"Parc de Can Zam",bands:["Accept","Helloween","Powerwolf","Twisted Sister"]},{inputs:["Rock Imperium"],name:"Rock Imperium",location:"Murcia (Cartagena)",place:"Parque el Batel",bands:["Iron Maiden","Sabaton","Within Temptation","4 Bajo Zero","Anthrax","Avulsed","Blues Pills","Crazy Lixx","Crimson Glory","Doble Esfera","Dogma","Estrella Negra","Evilact","Grand Magus","H.E.A.T","Hagane","Heleven","Lacuna Coil","Latzen","Mastodon","Presa","Queensr\xFFche","Rockin' Ladies Band","Testament","The Gathering","Triskel","Trivium","Uada","Wings of Steel"]},{inputs:["Rock the Sun"],name:"Rock the Sun",location:"Barcelona",place:"La Carpa (Poble Espanyol)",bands:[]},{inputs:["Sun And Thunder"],name:"Sun And Thunder",location:"M\xE1laga (Fuengirola)",place:"Marenostrum Fuengirola",bands:[]},{inputs:["Z! Live"],name:"Z! Live",location:"Zamora",place:"IFEZA",bands:["Twisted Sister","Brothers Of Metal","H.E.A.T","Noah Histeria","Romanthica","Serious Black","Soziedad Alkoholika","TesseracT","Xeria"]},{inputs:["Zurbar\xE1n Rock Fest"],name:"Zurbar\xE1n Rock Fest",location:"Burgos",place:"Parque San Agust\xEDn",bands:["Doro","Hardcore Superstar"]}];function ne(r,s){r&1&&(l(0,"p",5),m(1,"Reading..."),d())}function te(r,s){r&1&&(l(0,"p",5),m(1,"No upcoming concerts found."),d())}function ae(r,s){if(r&1&&D(0,"img",7),r&2){let p=I().$implicit;_("src",p.flyer,v)}}function ie(r,s){r&1&&D(0,"div",8)}function oe(r,s){if(r&1&&(l(0,"div",6),S(1,ae,1,1,"img",7)(2,ie,1,0,"div",8),l(3,"div",9)(4,"div",10),m(5),d(),l(6,"div",11),m(7),d(),l(8,"div",12),D(9,"img",13),m(10),d(),l(11,"div",14),m(12),d()()()),r&2){let p=s.$implicit,t=I();c(),T(p.flyer?1:2),c(4),E(t.getBands(p)),c(2),E(t.getParsedDate(p)),c(2),_("src",t.getFlagSVG(p.location),v),c(),$(" ",p.location||"Unknown"," "),c(2),E(p.place||"")}}var fe=(()=>{let s=class s{constructor(){this.isReading=!1}submit(t){let a=t.target?.files?.[0];if(a){let e=new FileReader;this.isReading=!0,e.onload=n=>{let i=this.getConcertJSONFromICS(n.target.result);this.isReading=!1,this.printEvents(i),this.printLocations(),this.printPlaces(),this.printBands(),this.printFests()},e.readAsText(a)}}getConcertJSONFromICS(t){return t.split("BEGIN:VEVENT").slice(1).map(e=>{let n=o=>{let F=e.match(o);return F?F[1].replace(/\r\n |[\r\n\\]/g,""):null},i=n(/DTSTART(?:;VALUE=DATE)?:(\d{8})/),U=n(/DTEND(?:;VALUE=DATE)?:(\d{8})/),q=n(/CREATED:(\d{8}T\d{6})/),Y=n(/LAST-MODIFIED:(\d{8}T\d{6})/),y=n(/SUMMARY:(.+?)\r?\n(?:[A-Z\-]+:|$)/s),J=n(/LOCATION:(.+?)\r?\n(?:[A-Z\-]+:|$)/s),w=n(/DESCRIPTION:(.+?)\r?\n(?:[A-Z\-]+:|$)/s),K=y?.includes("_"),C=o=>o?o.length===8?new Date(parseInt(o.substring(0,4)),parseInt(o.substring(4,6))-1,parseInt(o.substring(6,8))).toISOString():new Date(parseInt(o.substring(0,4)),parseInt(o.substring(4,6))-1,parseInt(o.substring(6,8)),parseInt(o.substring(9,11)),parseInt(o.substring(11,13)),parseInt(o.substring(13,15))).toISOString():null,g=w?.split("n*")?.map(o=>o.trim()),Q=g?.[0]?.includes("http")?g?.[0]?.includes("href=")?g.shift()?.match(/href="([^"]+)"/)?.[1]:g.shift():void 0,M=y?y.split(","):[],b=M[0]?.split("+")?.map(o=>o.replace("_","")?.trim())||[],X=M[1]?.trim(),ee=M[2]?.trim(),x;return K&&(x=b[0],b=g?.length?g:void 0),{startDate:C(i),endDate:C(U),creationDate:C(q),lastModifiedDate:C(Y),bands:b,location:X||void 0,place:ee||void 0,address:J||void 0,description:w||void 0,flyer:Q,block:e,fest:x}}).filter(e=>e.startDate&&new Date(e.startDate).getTime()>Date.now()).sort((e,n)=>new Date(e.startDate).getTime()-new Date(n.startDate).getTime())}getParsedDate(t){let a=i=>i.toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),e=i=>i.toLocaleDateString("es-ES",{day:"numeric",month:"long"}),n="";return t.startDate&&t.endDate?Math.round((new Date(t.endDate).getTime()-new Date(t.startDate).getTime())/864e5)>1?n=`${e(new Date(t.startDate))} \u2013 ${e(new Date(t.endDate))} ${new Date(t.endDate).getFullYear()}`:n=a(new Date(t.startDate)):t.startDate&&(n=a(new Date(t.startDate))),n}getFlagSVG(t){let a="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Flag_of_Spain.svg/750px-Flag_of_Spain.svg.png?20240115205409",e=u.find(n=>[...n.inputs,n.name].includes(t));return e?.community?j[e.community]:a}getBands(t){return t?.fest||t?.bands?.join(" + ")||"unknown"}printEvents(t){this.concerts=t?.map(a=>O(k({},a),{bands:a.bands?.map(e=>f.find(n=>n.inputs.includes(e))?.name||(e.includes("TBC")?e:e+"_NEW_")),location:u.find(e=>e.inputs.includes(a.location||""))?.name||a.location+"_NEW_",place:h.find(e=>e.inputs.includes(a.place||""))?.name||(a.place?.includes("TBC")?a.place:a.place+"_NEW_")})),console.log("EVENTS",this.concerts)}printLocations(){let t=new Set;u.map(e=>t.add(e.name)),this.concerts?.forEach(e=>t.add(e.location));let a=Array.from(t).sort((e,n)=>e.localeCompare(n)).map(e=>u?.find(n=>n.name===e||n.inputs.includes(e))||{inputs:[e],name:e,community:"_NEW_"}).reduce((e,n)=>(e.some(i=>i.name===n.name)||e.push(n),e),[]);console.log("LOCATIONS",a)}printPlaces(){let t=new Set;h.map(e=>t.add(`${e.name};${e.location}`)),this.concerts?.forEach(e=>{e.place&&!e.place.includes("TBC")&&t.add(`${e.place};${e.location}`)});let a=Array.from(t).sort((e,n)=>e.localeCompare(n)).map(e=>h?.find(n=>n.name===e.split(";")[0]||n.inputs.includes(e.split(";")[0]))||{inputs:[e.split(";")[0]],name:e.split(";")[0]+"_NEW_",location:u.find(n=>n.inputs.includes(e.split(";")[1]))?.name||e.split(";")[1]}).reduce((e,n)=>(e.some(i=>i.name===n.name)||e.push(n),e),[]);console.log("PLACES",a)}printBands(){let t=new Set;f.map(e=>t.add(e.name)),this.concerts?.forEach(e=>e.bands?.forEach(n=>!n.includes("TBC")&&t.add(n)));let a=Array.from(t).sort((e,n)=>e.localeCompare(n)).map(e=>f?.find(n=>n.name===e||n.inputs.includes(e))||{inputs:[e],name:e+"_NEW_",genres:[]}).reduce((e,n)=>(e.some(i=>i.name===n.name)||e.push(n),e),[]);console.log("BANDS",a)}printFests(){let t=new Set;A.map(e=>t.add(`${e.name};${e.location};${e.place}`)),this.concerts?.forEach(e=>e.fest&&t.add(`${e.fest};${e.location};${e.place}`));let a=Array.from(t).sort((e,n)=>e.localeCompare(n)).map(e=>A?.find(n=>n.name===e.split(";")[0]||n.inputs.includes(e.split(";")[0]))||{inputs:[e.split(";")[0]],name:e.split(";")[0]+"_NEW_",location:u.find(n=>n.inputs.includes(e.split(";")[1]))?.name||e.split(";")[1],place:h.find(n=>n.inputs.includes(e.split(";")[2]))?.name||e.split(";")[2],bands:this.concerts?.find(n=>n.fest===e.split(";")[0])?.bands?.map(n=>f.find(i=>i.inputs.includes(n))?.name||n)||[]}).reduce((e,n)=>(e.some(i=>i.name===n.name)||e.push(n),e),[]);console.log("FESTS",a)}};s.\u0275fac=function(a){return new(a||s)},s.\u0275cmp=R({type:s,selectors:[["app-ics"]],decls:12,vars:3,consts:[[3,"translucent"],[1,"ion-padding"],["id","controls"],["type","file","id","fileInput","accept",".ics",3,"change"],["id","output"],[1,"no-events"],[1,"card"],["alt","Flyer",1,"flyer",3,"src"],[1,"flyer"],[1,"card-content"],[1,"bands"],[1,"date"],[1,"location"],["alt","flag",1,"flag",3,"src"],[1,"place"]],template:function(a,e){a&1&&(l(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),m(3,"Conciertos de Heavy Metal en Espa\xF1a"),d()()(),l(4,"ion-content",1)(5,"div",2)(6,"input",3),N("change",function(i){return e.submit(i)}),d()(),l(7,"div",4),S(8,ne,2,0,"p",5),S(9,te,2,0,"p",5),L(10,oe,13,6,"div",6,P),d()()),a&2&&(_("translucent",!0),c(8),T(e.isReading?8:-1),c(),T(e.concerts?-1:9),c(),B(e.concerts))},dependencies:[V,H,W,Z,z,G],styles:["body[_ngcontent-%COMP%]{font-family:system-ui,sans-serif;background-color:#f5f7fa;margin:0;padding:2rem;color:#333}h1[_ngcontent-%COMP%]{text-align:center;margin-bottom:4rem}#controls[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;margin-bottom:2rem}input[type=file][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{font-size:1rem;padding:.5rem 1rem}#output[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.5rem}.card[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;box-shadow:0 4px 12px #0000001a;overflow:hidden;display:flex;flex-direction:column;transition:transform .2s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.flyer[_ngcontent-%COMP%]{width:100%;height:220px;object-fit:cover;background:#ddd}.card-content[_ngcontent-%COMP%]{padding:1rem;display:flex;flex-direction:column;gap:.5rem}.bands[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:#222}.date[_ngcontent-%COMP%]{color:#555;font-weight:500}.location[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:#333;font-weight:500}.flag[_ngcontent-%COMP%]{width:20px;height:14px;border-radius:2px;object-fit:cover;border:1px solid #ccc}.place[_ngcontent-%COMP%]{font-style:italic;color:#666}.no-events[_ngcontent-%COMP%]{text-align:center;font-size:1.2rem;color:#777;margin-top:2rem}"]});let r=s;return r})();export{fe as IcsPage};
